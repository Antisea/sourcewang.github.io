---
layout: post
title: Linux Kernel Sendfile
---

## Sendfile

### Sendfile机制：

> 用户将请求发给内核，内核根据用户的请求调用相应的用户进程，进程在处理时需要资源，此时再把请求发给内核（进程没有直接IO的能力），
由内核加载数据。内核查找到数据之后，会把数据复制给用户进程，由用户进程对数据进行封装，之后交给内核，内核在进行tcp/ip 首部的
封装，最后在发送给客户端。这个功能用户进程只是发生了一个封装报文的过程，却要绕一大圈。

> 因此ngix 引入了sendfile 机制，使得内核在接收到数据之后，不再依靠用户进程给予封装，而是自己查找自己封装，减少了一个很长一段
时间的浪费，这是一个提升性能的核心点。

> 简单来说，就是资源的处理，直接通过内核层进行数据传递，避免了数据传递到应用层，应用层再传递到内核层的开销。

> 目前高并发的处理一般都是采用sendfile 模式，通过直接操作内核层数据减少应用于内核层数据传递

2016-05-10-The-difference-between-buffers-and-cached.md
